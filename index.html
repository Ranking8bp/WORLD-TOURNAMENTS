<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Ranking de Copas - 8 Ball Pool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
/* ================= VARIABLES ================= */
:root {
  --bg-main:#050712;
  --bg-card:#0b0f1f;
  --accent:#00ffc6;
  --accent-soft:rgba(0,255,198,.12);
  --text-main:#f5f7ff;
  --text-muted:#9ca3c7;
  --gold:#ffd700;
  --silver:#c0c0c0;
  --bronze:#cd7f32;
  --border-soft:rgba(255,255,255,.08);
  --radius-lg:18px;
  --shadow-soft:0 18px 40px rgba(0,0,0,.55);
  --font-main:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
}

/* ================= BASE ================= */
*{box-sizing:border-box;margin:0;padding:0}
html,body{width:100%;overflow-x:hidden}

body{
  font-family:var(--font-main);
  background:radial-gradient(circle at top,#192345 0,#050712 55%);
  color:var(--text-main);
  min-height:100vh;
  display:flex;
  justify-content:center;
  padding:24px;
}

.page{width:100%;max-width:1120px}

/* ================= HEADER ================= */
.head{
  display:flex;
  justify-content:space-between;
  margin-bottom:20px;
  gap:16px;
  align-items:center;
}

.head h1{
  font-size:26px;
  display:flex;
  gap:10px;
  align-items:center;
}

.logo-dot{
  width:9px;
  height:9px;
  border-radius:50%;
  background:var(--accent);
  box-shadow:0 0 12px var(--accent);
}

.head p{font-size:13px;color:var(--text-muted)}

/* ================= CARD ================= */
.card{
  background:linear-gradient(135deg,rgba(0,255,198,.03),rgba(0,128,255,.02));
  border-radius:18px;
  padding:18px;
  border:1px solid var(--border-soft);
  box-shadow:var(--shadow-soft);
}

/* ================= TABLE ================= */
.table-wrapper{
  border-radius:14px;
  overflow:auto;
  border:1px solid var(--border-soft);
  background:#050712;
  max-height:520px;
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:13px;
}

thead{background:#0b0f1f}

th,td{
  padding:10px 12px;
  white-space:nowrap;
}

th{
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:.12em;
  color:var(--text-muted);
}

tbody tr{
  background:#050712;
  cursor:pointer;
}

tbody tr:nth-child(even){
  background:#0a0c18;
}

tbody tr:hover{
  background:#121836;
}

/* ================= PLAYER ================= */
.player-cell{
  display:flex;
  align-items:center;
  gap:10px;
}

.avatar{
  width:32px;
  height:32px;
  border-radius:50%;
  border:1px solid var(--border-soft);
  background:#1f2937;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
  font-weight:600;
  color:var(--accent);
}

.avatar img{
  width:100%;
  height:100%;
  object-fit:cover;
}

/* ================= GIF EFFECT ================= */
.avatar.has-gif{
  border:2px solid #00ffc6;
  box-shadow:0 0 12px #00ffc6;
  animation:glow 1.6s infinite alternate;
}

/* ================= TOP 3 ================= */
tr:nth-child(1) .avatar{
  border-color:gold;
  box-shadow:0 0 15px gold;
}

tr:nth-child(2) .avatar{
  border-color:silver;
  box-shadow:0 0 15px silver;
}

tr:nth-child(3) .avatar{
  border-color:#cd7f32;
  box-shadow:0 0 15px #cd7f32;
}

@keyframes glow{
  from{box-shadow:0 0 8px #00ffc6}
  to{box-shadow:0 0 18px #00ffc6}
}

/* ================= FOOTER ================= */
.footer{
  margin-top:10px;
  display:flex;
  justify-content:space-between;
  font-size:11px;
  color:var(--text-muted);
}
</style>
</head>

<body>

<div class="page">

<header class="head">
  <div>
    <h1><span class="logo-dot"></span>Ranking de Copas · 8 Ball Pool</h1>
    <p>Historial oficial · Torneos nocturnos</p>
  </div>
</header>

<main class="card">

<section class="table-wrapper">

<table>
<thead>
<tr>
<th>#</th>
<th>Jugador</th>
<th>País</th>
<th>Copas</th>
<th>Última</th>
<th>Notas</th>
</tr>
</thead>

<tbody id="ranking-body"></tbody>
</table>

</section>

<footer class="footer">
<span>1 copa = 1 torneo ganado</span>
<span>Liga Nocturna</span>
</footer>

</main>
</div>

<script>

/* ================= GOOGLE SHEET ================= */

const SHEET_CSV_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vQ_0o0lo_oqp60rh4u_bOvadsM0MqWJxzQgcz37DDA9CpP0zujrJ2pkKEBhCGhV8G3bMGOxJGDFdI0O/pub?gid=0&single=true&output=csv";

let jugadoresGlobal=[];

/* ================= CSV ================= */

function parseCSV(text){

  const rows=[];
  const lines=text.split("\n");

  for(let line of lines){

    const cols=[];
    let cur="";
    let inside=false;

    for(let c of line){

      if(c==='"') inside=!inside;
      else if(c==="," && !inside){
        cols.push(cur);
        cur="";
      }else cur+=c;

    }

    cols.push(cur);
    rows.push(cols);
  }

  return rows;
}

/* ================= UTILS ================= */

function iniciales(nombre){
  return nombre.split(" ")
  .filter(Boolean)
  .map(p=>p[0])
  .join("")
  .slice(0,2)
  .toUpperCase();
}

/* ================= ROW ================= */

function crearFila(pos,j,pais,copas,ultima,notas,foto){

  const ini=iniciales(j);
  const isGif=foto && foto.toLowerCase().endsWith(".gif");

  const content=foto
    ? `<img src="${foto}" onerror="this.parentElement.textContent='${ini}'">`
    : ini;

  return`
<tr data-rank="${pos}">
<td><b>${pos}</b></td>

<td>
<div class="player-cell">
<div class="avatar ${isGif?"has-gif":""}">
${content}
</div>
<span>${j}</span>
</div>
</td>

<td>${pais}</td>
<td>${copas}</td>
<td>${ultima}</td>
<td>${notas}</td>
</tr>`;
}

/* ================= RENDER ================= */

function render(lista){

const tbody=document.getElementById("ranking-body");

tbody.innerHTML=lista.map(j=>
crearFila(
j.rank,
j.jugador,
j.pais,
j.copas,
j.ultimaCopa,
j.notas,
j.foto
)).join("");

}

/* ================= LOAD ================= */

async function cargar(){

try{

const res=await fetch(SHEET_CSV_URL);
const text=await res.text();

const parsed=parseCSV(text).slice(1);

jugadoresGlobal=parsed.map(cols=>({

jugador:(cols[0]||"").trim(),
pais:(cols[1]||"").trim(),
copas:Number((cols[2]||"0").trim()),
ultimaCopa:(cols[3]||"").trim(),
notas:(cols[4]||"").trim(),

/* GIF L -> FOTO F */
foto:(cols[11]||cols[5]||"").trim(),

}))

.filter(j=>j.jugador)
.sort((a,b)=>b.copas-a.copas)
.map((j,i)=>({...j,rank:i+1}));

render(jugadoresGlobal);

}catch(e){
console.error(e);
}

}

document.addEventListener("DOMContentLoaded",cargar);

</script>

</body>
</html>
